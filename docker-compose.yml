version: "2.2"

services:
  btc-bot:
    build: .
    container_name: btc-trend-breakout-bot
    restart: unless-stopped
    environment:
      TG_BOT_TOKEN: "${TG_BOT_TOKEN}"
      TG_CHAT_ID: "${TG_CHAT_ID}"

      SYMBOL: "${SYMBOL:-BTCUSDT}"
      POLL_SEC: "${POLL_SEC:-5}"
      CONFIRM_SEC: "${CONFIRM_SEC:-60}"
      COOLDOWN_SEC: "${COOLDOWN_SEC:-180}"

      SL_ATR: "${SL_ATR:-0.8}"
      TP_ATR: "${TP_ATR:-1.2}"

      EMA_FILTER_1H: "${EMA_FILTER_1H:-true}"
      EMA_PERIOD: "${EMA_PERIOD:-200}"
      EMA_KLINES_LIMIT: "${EMA_KLINES_LIMIT:-300}"

      STATE_FILE: "${STATE_FILE:-/app/data/btc_trend_breakout_state.json}"
      PAPER_TRADING: "${PAPER_TRADING:-true}"
      START_CASH_USDT: "${START_CASH_USDT:-1000}"     # ถ้าจะเทียบ 10,000 THB ~ 280-300 USDT (แล้วแต่เรท)
      ORDER_PCT: "${ORDER_PCT:-1.0}"                 # ใช้เงินกี่ % ต่อการเข้า 1 ครั้ง (1.0 = all-in)
      FEE_RATE: "${FEE_RATE:-0.001}"                 # fee 0.1% (ปรับได้)
      SLIPPAGE_RATE: "${SLIPPAGE_RATE:-0.0005}"      # slippage 0.05%
      REPORT_EVERY_SEC: "${REPORT_EVERY_SEC:-3600}"  # รายงานทุก 1 ชั่วโมง

    volumes:
      - ./data:/app/data
    working_dir: /app
